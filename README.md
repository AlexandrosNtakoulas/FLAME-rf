
### MACHINE-LEARNING AND MODEL REDUCTIONFRAMEWORK DEVELOPMENT FOR DNS DATA
Python-based open source frameworks
offer powerful platforms to assist the
construction of reduced order models
as well as for machine learning applications.
The aim of this project is to develop a
general framework that will simplify
and accelerate the application of such
tools on high-fidelity data generated by
spectral element solvers for the direct
numerical simulation (DNS) of low
Mach number reactive flows. The
framework will be used on existing
DNS data from different setups. Depending
on progress, new simulations
will also be performed for lean hydrogen-
air premixed flames to enrich the
existing datasets.

This repository contains the codebase developed as part of my Bachelor Thesis at **ETH ZÃ¼rich (D-MAVT)**, conducted in the **Computational and Applied Physics / Combustion Laboratory (CAPS)**.  
The project focuses on **data-driven modeling of hydrogen combustion** using **Direct Numerical Simulation (DNS)** data obtained from the **Nek5000** spectral-element solver.

---

## ðŸ“˜ Overview

The goal of this work is to establish a reproducible computational pipeline that:
1. Extracts local flame characteristics (e.g., curvature, strain, species concentrations) from high-fidelity DNS data.
2. Performs **feature scaling, dimensionality reduction, and symbolic regression** to uncover physical relations governing the **flame displacement speed**.
3. Bridges **physics-based modeling** with **data-driven discovery** through interpretable and efficient machine-learning models.

---

## ðŸ§© Project Structure

````text
Code/
â”œâ”€â”€ Data_preprocessing.ipynb # Load and preprocess DNS data (H2-air flames)
â”œâ”€â”€ Dimentionality_Reduction.ipynb # Apply PCA, UMAP, autoencoders for latent analysis
â”œâ”€â”€ Symbolic_Regression.ipynb # PySR and SINDy for interpretable model discovery
â”‚
â”œâ”€â”€ pySEMTools/ # Local library for SEM data handling (I/O + operations)
â”‚ â”œâ”€â”€ pysemtools/ # Core module (Mesh, Field, Coef classes)
â”‚ â”œâ”€â”€ examples/ # Example usage scripts and test cases
â”‚ â””â”€â”€ tests/ # Unit tests for core components
â”‚
â”œâ”€â”€ chem.cti # Cantera mechanism for hydrogen combustion
â”œâ”€â”€ requirements.txt # Python dependencies
â”œâ”€â”€ outputs/ # Regression and analysis results (auto-generated)
â”‚ â””â”€â”€ 20251028_203355_tqOaJA/ # Example symbolic regression run
â”‚
â”œâ”€â”€ .gitignore # Ignore list for version control
â””â”€â”€ README.md # Repository documentation
````

## Info
- Mesh:200x400 mesh_2Dsmall.jou
- change cantera input file in *usr
- pyvtk, pyvista, mayavi
- grep hrr mpi-out.48228984| awk ' NR>1 { print $6, $5}' > iHRR_01
## Questions:
- Might not need Xwindows cause I have WSLg but gnuplot doesnt have the correct terminal
- Clustering first or after dimensionality reduction?
- Does it make sense to UQ?(With Bayesian inference) Or deterministic is better?
---
## New to dos:
- setup adaptive velocity
- comparative study on dimensionality reduction methods
- Setup parallel visit
- Intepretability metrics
- SHoould I do 1 simulation at a time or multiple
- Interpretable Discriminative Dimensionality Reduction and Feature Selection on the Manifold
- LXDR (Local eXplanation of Dimensionality Reduction)
- Res-VAE used in biology
- try grace
- Nonlinear dimensionality reduction for clustering
- There exist combinations of DR+Clustering e.g. VAE-SNE
- A VAE whose latent space is reshaped by a t-SNEâ€“style neighborhood loss.
The VAE gives you a smooth generative latent space; the SNE term sculpts that space so that local neighborhoods (and clusters) in data space are preserved
----

## Comparison of DR
- PCA
- Reguralized AE
- 
- UMAP + clustering?
- tSNE + clustering?
- Change type of features of clustering
# Targets
- Chemistry Reduction
- Do summary of all relations for FDS and compare to a ML model
## To cluster:
- Extinction limits
- Supervised Clustering for Optimal Subâ€‘model Selection
- Different flame front regions, figure out most important features in each region(PCA)
- After clustering look at how a horyontal line through the flame transltes in the latent space
## To infer variables: 
- Sd -> Main focus, G equation
- Flame surface density
- Reaction rates
- Nox emmisions
- Flame wall heatflux interaction
- Models are evaluated on predictions of the sub-filter PDF as well as predictions of the filtered reaction
rate of the progress variable, computed through an integral of the product of the sub-filter PDF and the
conditional means of the reaction rate
## To find dynamics of:
- Flame front?
- Reaction rates
- Chemical kinetics
- 

# Methods
## Clustering & Dimensionality Reduction:
- local PCA(+clustering)
- UMAP + HDBSCAN: UMAP is good for clustering high dimensional data.
- Diffusion maps: Better for figuring intrinsic coordinates and building ROMs. Not as good for clustering
- Autoencoder
- Volume regularized AE
- Laplacian eigenmaps, ...
## Inference:
- VAE, normalizing flow, flow matching, etc
- Symbolic Regression
- Parallel symbolic enumeration (PSE)
- Parsimonous NN for interpretable laws
- Gaussian Processes
- ResNet
- NN and captum for interpretability

## Dynamics prediction:
- Vanilla SinDy, Variational SinDy
- FNO, Koopman operators
- SciNet
- (PINN)

## pySEMtools: Averaging across elements and taking derivatives
- coef can use torch for gpu
- pySEMtools does not do any averaging of the derivatives
- it calculates them in the ref domain and then transforms them to the physical domain
- An averaging among the elements included in a single MPI rank is mentioned in dssum
- A filtering function also exists(I think it's a low pass filter)
- There are interpolation functions
- The function it uses for isosurfaces calls pivista
